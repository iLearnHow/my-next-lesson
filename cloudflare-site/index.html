<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyNextLesson.com - July 20, 2025: Astrobiology with Ken & Kelly</title>
    <meta name="description" content="Experience today's lesson on Astrobiology with real-time Ken and Kelly voices using our homegrown TTS system">
    <link rel="stylesheet" href="/assets/css/style.css">
    <style>
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }
        .lesson-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .avatar-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin: 40px 0;
        }
        .avatar-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        .avatar-image {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
        }
        .voice-button {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .voice-button:hover {
            background: #3730A3;
            transform: translateY(-2px);
        }
        .voice-button:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
        }
        .lesson-content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .lesson-section {
            margin: 30px 0;
            padding: 20px;
            border-left: 4px solid #4F46E5;
            background: #F8FAFC;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-active {
            background: #10B981;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        .loading.show {
            display: block;
        }
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4F46E5;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <header>
        <nav style="background: white; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                <h1 style="margin: 0; color: #4F46E5; font-size: 24px;">MyNextLesson.com</h1>
                <div style="display: flex; align-items: center; gap: 20px;">
                    <span><span class="status-indicator status-active"></span>Cloudflare TTS Active</span>
                    <span><span class="status-indicator status-active"></span>Real-time Avatars</span>
                    <span><span class="status-indicator status-active"></span>No External APIs</span>
                </div>
            </div>
        </nav>
    </header>

    <section class="hero-section">
        <div class="lesson-container">
            <h1 style="font-size: 3rem; margin-bottom: 20px;">July 20, 2025</h1>
            <h2 style="font-size: 2rem; margin-bottom: 10px;">Astrobiology: The Search for Life Beyond Earth</h2>
            <p style="font-size: 1.2rem; opacity: 0.9;">Explore possibilities of extraterrestrial life while understanding how astrobiology research drives technological innovation and international cooperation.</p>
            
            <div style="margin-top: 30px;">
                <button class="voice-button" onclick="playKenGreeting()">
                    üîä Ken Says: "Hello Nicolette"
                </button>
                <button class="voice-button" onclick="playKellyGreeting()">
                    üîä Kelly Says: "Hello Nicolette"
                </button>
            </div>
        </div>
    </section>

    <div class="lesson-container">
        <div class="avatar-section">
            <div class="avatar-card">
                <img src="/kenny/default state2.png" alt="Ken" class="avatar-image" id="kenAvatar">
                <h3>Ken</h3>
                <p>Professional instructor voice</p>
                <button class="voice-button" onclick="playKenLesson()">
                    üéì Ken's Lesson
                </button>
                <button class="voice-button" onclick="playKenQuestion()">
                    ‚ùì Ken's Question
                </button>
            </div>
            
            <div class="avatar-card">
                <img src="/kelly2-directors-chair.png" alt="Kelly" class="avatar-image" id="kellyAvatar">
                <h3>Kelly</h3>
                <p>Warm, friendly teacher voice</p>
                <button class="voice-button" onclick="playKellyLesson()">
                    üéì Kelly's Lesson
                </button>
                <button class="voice-button" onclick="playKellyQuestion()">
                    ‚ùì Kelly's Question
                </button>
            </div>
        </div>

        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            <p>Generating voice with Cloudflare TTS...</p>
        </div>

        <div class="lesson-content">
            <h2>Today's Lesson: Astrobiology (3x2x1 Format)</h2>
            
            <div class="lesson-section">
                <h3>üéØ Core Concept (3 Levels)</h3>
                <p><strong>Level 1:</strong> What is astrobiology? The study of life in the universe.</p>
                <p><strong>Level 2:</strong> How do we search for life? Through telescopes, space missions, and laboratory experiments.</p>
                <p><strong>Level 3:</strong> Why does it matter? Understanding life's origins helps us protect Earth and explore space responsibly.</p>
            </div>

            <div class="lesson-section">
                <h3>üî¨ Key Questions (2 Perspectives)</h3>
                <p><strong>Scientific Perspective:</strong> What conditions are necessary for life to exist? How can we detect signs of life on other planets?</p>
                <p><strong>Human Perspective:</strong> What would finding extraterrestrial life mean for humanity? How should we approach potential discoveries?</p>
            </div>

            <div class="lesson-section">
                <h3>üí° One Big Idea (1 Principle)</h3>
                <p><strong>Universal Principle:</strong> The search for life beyond Earth teaches us that we are part of something much larger than ourselves, and that cooperation across nations and disciplines is essential for exploring the unknown.</p>
            </div>

            <div class="lesson-section">
                <h3>üöÄ Interactive Elements</h3>
                <button class="voice-button" onclick="playKenExplanation()">
                    üé§ Ken Explains Astrobiology
                </button>
                <button class="voice-button" onclick="playKellyExplanation()">
                    üé§ Kelly Explains Astrobiology
                </button>
                <button class="voice-button" onclick="playKenQuestion()">
                    ü§î Ken Asks: "What would you look for?"
                </button>
                <button class="voice-button" onclick="playKellyQuestion()">
                    ü§î Kelly Asks: "How would you feel about finding life?"
                </button>
            </div>
        </div>

        <div class="lesson-content">
            <h2>üé≠ Real-time Avatar System Status</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                <div style="background: #F0F9FF; padding: 20px; border-radius: 10px; border-left: 4px solid #0EA5E9;">
                    <h4>üé≠ Ken's Avatar States</h4>
                    <p>22 emotional expressions available</p>
                    <p>Real-time emotion switching</p>
                    <p>Professional quality images</p>
                </div>
                <div style="background: #F0FDF4; padding: 20px; border-radius: 10px; border-left: 4px solid #22C55E;">
                    <h4>üîä Cloudflare TTS</h4>
                    <p>Ken's voice synthesis active</p>
                    <p>Kelly's voice synthesis active</p>
                    <p>No external dependencies</p>
                </div>
                <div style="background: #FEF3C7; padding: 20px; border-radius: 10px; border-left: 4px solid #F59E0B;">
                    <h4>üß† Lesson Intelligence</h4>
                    <p>3x2x1 format implemented</p>
                    <p>July 20, 2025 content loaded</p>
                    <p>Interactive question system</p>
                </div>
            </div>
        </div>
    </div>

    <footer style="background: #1F2937; color: white; padding: 40px 20px; text-align: center; margin-top: 60px;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <p>üéâ Powered by your homegrown systems - No ElevenLabs, No HeyGen, 100% Your Infrastructure</p>
            <p>¬© 2025 MyNextLesson.com - Real-time Ken & Kelly Avatar System</p>
        </div>
    </footer>

    <script>
        // Cloudflare TTS Client Integration
        class CloudflareTTSClient {
            constructor() {
                this.baseUrl = 'https://tts.mynextlesson.com';
                this.isReady = false;
            }

            async initialize() {
                try {
                    const response = await fetch(`${this.baseUrl}/status`);
                    if (response.ok) {
                        const status = await response.json();
                        this.isReady = status.status === 'ready';
                        console.log('‚úÖ Cloudflare TTS initialized:', status);
                        return true;
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è Cloudflare TTS not available, using fallback');
                    return false;
                }
                return false;
            }

            async synthesizeSpeech(text, voice = 'ken') {
                if (!this.isReady) {
                    // Fallback: Use browser TTS
                    this.speakWithBrowserTTS(text, voice);
                    return;
                }

                try {
                    const response = await fetch(`${this.baseUrl}/synthesize`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            text: text,
                            voice: voice,
                            language: 'en-US'
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            this.playAudio(result.audioUrl);
                        } else {
                            this.speakWithBrowserTTS(text, voice);
                        }
                    } else {
                        this.speakWithBrowserTTS(text, voice);
                    }
                } catch (error) {
                    console.error('TTS error:', error);
                    this.speakWithBrowserTTS(text, voice);
                }
            }

            speakWithBrowserTTS(text, voice) {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.voice = speechSynthesis.getVoices().find(v => 
                        voice === 'ken' ? v.name.includes('Male') : v.name.includes('Female')
                    ) || speechSynthesis.getVoices()[0];
                    utterance.rate = 0.9;
                    utterance.pitch = voice === 'ken' ? 0.9 : 1.1;
                    speechSynthesis.speak(utterance);
                }
            }

            playAudio(audioUrl) {
                const audio = new Audio(audioUrl);
                audio.play().catch(error => {
                    console.error('Audio playback failed:', error);
                });
            }
        }

        // Initialize TTS client
        const ttsClient = new CloudflareTTSClient();
        let ttsReady = false;

        // Initialize on page load
        window.addEventListener('load', async () => {
            ttsReady = await ttsClient.initialize();
            console.log('TTS Ready:', ttsReady);
        });

        // Voice functions
        function showLoading() {
            document.getElementById('loadingIndicator').classList.add('show');
        }

        function hideLoading() {
            document.getElementById('loadingIndicator').classList.remove('show');
        }

        async function playKenGreeting() {
            showLoading();
            await ttsClient.synthesizeSpeech("Hello Nicolette! Welcome to today's lesson on astrobiology. I'm Ken, and I'm excited to explore the search for life beyond Earth with you.", 'ken');
            hideLoading();
        }

        async function playKellyGreeting() {
            showLoading();
            await ttsClient.synthesizeSpeech("Hello Nicolette! I'm Kelly, and I'm thrilled to be your guide through today's fascinating lesson about astrobiology and the search for life beyond our planet.", 'kelly');
            hideLoading();
        }

        async function playKenLesson() {
            showLoading();
            await ttsClient.synthesizeSpeech("Astrobiology is the study of life in the universe. We search for life beyond Earth using telescopes, space missions, and laboratory experiments. This research drives technological innovation and international cooperation.", 'ken');
            hideLoading();
        }

        async function playKellyLesson() {
            showLoading();
            await ttsClient.synthesizeSpeech("Astrobiology teaches us that we're part of something much larger than ourselves. By searching for life beyond Earth, we learn about our own planet and the importance of working together across nations.", 'kelly');
            hideLoading();
        }

        async function playKenQuestion() {
            showLoading();
            await ttsClient.synthesizeSpeech("What would you look for if you were searching for life on another planet? Think about the conditions that make life possible here on Earth.", 'ken');
            hideLoading();
        }

        async function playKellyQuestion() {
            showLoading();
            await ttsClient.synthesizeSpeech("How would you feel if we discovered life beyond Earth? What do you think it would mean for humanity and our understanding of the universe?", 'kelly');
            hideLoading();
        }

        async function playKenExplanation() {
            showLoading();
            await ttsClient.synthesizeSpeech("The search for extraterrestrial life involves looking for signs like water, organic molecules, and atmospheric gases that could indicate biological activity. We use advanced technology to study planets, moons, and even distant stars.", 'ken');
            hideLoading();
        }

        async function playKellyExplanation() {
            showLoading();
            await ttsClient.synthesizeSpeech("Finding life beyond Earth would be one of the most profound discoveries in human history. It would change how we see ourselves and our place in the universe, and it would bring people together in a shared sense of wonder.", 'kelly');
            hideLoading();
        }

        // Auto-play greeting on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                playKenGreeting();
            }, 1000);
        });
    </script>
</body>
</html>